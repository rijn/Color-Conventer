!function(window,document,undefined){"use strict";function ColorConverter(a){var b=this;if(b.colors=[],!(b instanceof ColorConverter))return new ColorConverter(a);b.options=a||{};for(var c in defaults)null==b.options[c]&&(b.options[c]=defaults[c]);b.options.colors&&b["import"](b.options.colors)}Array.prototype.forEach=function(a,b){var c=this.length,b=arguments[1];if("function"!=typeof a)throw Error("unknown function");for(var d=0;c>d;d++)a.call(b,this[d],d,this)},Array.prototype.getLast=function(){return this instanceof Array?this[this.length-1]:!1},Array.prototype.search=function(a){if(this instanceof Array){var b=[];for(var c in this)this[c]==a&&b.push(c);var d=b.length;return 0==d?!1:1==d?b[0]:b}return!1},Object.prototype.clone=function(a){if("object"!=typeof this)return this;if(null==this)return this;var b=this instanceof Array?new Array:new Object;for(var c in this)b[c]=this[c].clone();return b};var flatten=function(a){for(var b=function(a,b){return null!=a&&hasOwnProperty.call(a,b)},c=function(a){var b=a&&a.length;return"number"==typeof b&&b>=0},d=function(a){return"[object Array]"===toString.call(a)},e=function(a){return b(a,"callee")},f=[],g=0,h=0,i=a&&a.length;i>h;h++){var j=a[h];if(c(j)&&(d(j)||e(j))){j=flatten(j);var k=0,l=j.length;for(f.length+=l;l>k;)f[g++]=j[k++]}else f[g++]=j}return f},min=function(){for(var a=flatten([arguments]),b=a[0],c=0;c<a.length;c++)b>a[c]&&(b=a[c]);return b},max=function(){for(var a=flatten([arguments]),b=a[0],c=0;c<a.length;c++)b<a[c]&&(b=a[c]);return b},acc={div:function(a,b){var c,d,e=0,f=0;try{e=a.toString().split(".")[1].length}catch(g){}try{f=b.toString().split(".")[1].length}catch(g){}return c=Number(a.toString().replace(".","")),d=Number(b.toString().replace(".","")),acc.mul(c/d,Math.pow(10,f-e))},mul:function(a,b){var c=0,d=a.toString(),e=b.toString();try{c+=d.split(".")[1].length}catch(f){}try{c+=e.split(".")[1].length}catch(f){}return Number(d.replace(".",""))*Number(e.replace(".",""))/Math.pow(10,c)},add:function(a,b){var c,d,e;try{c=a.toString().split(".")[1].length}catch(f){c=0}try{d=b.toString().split(".")[1].length}catch(f){d=0}return e=Math.pow(10,Math.max(c,d)),Number((a*e+b*e)/e)},sub:function(a,b){var c,d,e,f;try{c=a.toString().split(".")[1].length}catch(g){c=0}try{d=b.toString().split(".")[1].length}catch(g){d=0}return e=Math.pow(10,Math.max(c,d)),f=c>=d?c:d,Number(((a*e-b*e)/e).toFixed(f))}},spaces={RGB:{"import":function(){var a=flatten(arguments),b=[];if(a.length<3){var c=/([0-9a-fA-F]{6}|[0-9a-fA-F]{3})/,d=a[0].toLowerCase();if(!d||!c.test(d))return!1;if(d=c.exec(d)[0],3===d.length){for(var e="",f=0;3>f;f+=1)e+=d.slice(f,f+1).concat(d.slice(f,f+1));d=e}for(var b=[],f=0;6>f;f+=2)b.push(parseInt("0x"+d.slice(f,f+2)))}else for(var f=0;3>f;f++)b[f]=Number(a[f]);for(var f in b){if(b[f]<0)return!1;if(b[f]>255)return!1}return{RGB:{R:b[0],G:b[1],B:b[2]}}},XYZ:{convert:function(a){return{X:199049*a.B+394494*a.G+455033*a.R+524288>>20,Y:75675*a.B+749900*a.G+223002*a.R+524288>>20,Z:915161*a.B+114795*a.G+18621*a.R+524288>>20}},cost:1},CMY:{convert:function(a){var b,c,d;return b=(255-a.R)/255,c=(255-a.G)/255,d=(255-a.B)/255,{C:b,M:c,Y:d}},cost:0},CMYK:{convert:function(a){var b,c,d,e;return e=0,b=(255-a.R)/255,c=(255-a.G)/255,d=(255-a.B)/255,e=min([b,c,d]),1==e?b=c=d=0:(b=(b-e)/(1-e),c=(c-e)/(1-e),d=(d-e)/(1-e)),{C:b,M:c,Y:d,K:e}},cost:0},HSL:{convert:function(a){var b,c,d,e,f,g=a.R/255,h=a.G/255,i=a.B/255,j=min(g,h,i),k=max(g,h,i),l=k-j,m=(k+j)/2;return 0==l?(e=0,f=0):(f=.5>m?l/(k+j):l/(2-k-j),b=((k-g)/6+l/2)/l,c=((k-h)/6+l/2)/l,d=((k-i)/6+l/2)/l,g==k?e=d-c:h==k?e=1/3+b-d:i==k&&(e=2/3+c-b),0>e&&(e+=1),e>1&&(e-=1)),{H:360*e,S:f,L:m}},cost:0},HSV:{convert:function(a){var b,c,d,e=a.R/255,f=a.G/255,g=a.B/255,h=min(e,f,g),i=max(e,f,g);if(h==i)return d=h,{H:0,S:0,V:d};var j=e==h?f-g:g==h?e-f:g-e,k=e==h?3:g==h?1:5;return b=60*(k-j/(i-h)),c=(i-h)/i,d=i,{H:b,S:c,V:d}},cost:0}},CMY:{"import":function(){var a=flatten(arguments);if(a.length<3)return!1;for(var b=0;3>b;b++)if(a[b]<0||a[b]>1)return!1;return{CMY:{C:a[0],M:a[1],Y:a[2]}}},RGB:{convert:function(a){var b,c,d;return b=255*(1-_cmyk.C),c=255*(1-_cmyk.M),d=255*(1-_cmyk.Y),{R:b,G:c,B:d}},cost:0}},RGBA:{"import":function(){var a=flatten(arguments);if(a.length<7)return!1;for(var b=0;7>b;b++)if(a[b]<0||a[b]>255)return!1;return a[3]>1?!1:{RGBA:{FR:a[0],FG:a[1],FB:a[2],Alpha:a[3],BR:a[4],BG:a[5],BB:a[6]}}},RGB:{convert:function(a){return{R:(1-a.Alpha)*a.BR+a.Alpha*a.FR,G:(1-a.Alpha)*a.BG+a.Alpha*a.FG,B:(1-a.Alpha)*a.BB+a.Alpha*a.FB}},cost:1}},CMYK:{"import":function(){var a=flatten(arguments);if(a.length<4)return!1;for(var b=0;4>b;b++)if(a[b]<0||a[b]>1)return!1;return{CMYK:{C:a[0],M:a[1],Y:a[2],K:a[3]}}},RGB:{convert:function(a){var b,c,d;return b=(1-a.K)*(1-a.C)*255,c=(1-a.K)*(1-a.M)*255,d=(1-a.K)*(1-a.Y)*255,{R:b,G:c,B:d}},cost:0}},HSL:{"import":function(){var a=flatten(arguments);return a.length<3?!1:a[0]<0||a[0]>360||a[1]<0||a[2]<0||a[1]>1||a[2]>1?!1:{HSL:{H:a[0],S:a[1],L:a[2]}}},RGB:{convert:function(a){var b,c,d,e=a.H,f=a.S,g=a.L,h=acc.mul(acc.sub(1,Math.abs(acc.sub(acc.mul(2,g),1))),f),i=e/60,j=acc.mul(h,1-Math.abs(i%2-1)),k=parseInt(i),l=acc.sub(g,acc.div(h,2));switch(k){case 0:b=h,c=j,d=0;break;case 1:b=j,c=h,d=0;break;case 2:b=0,c=h,d=j;break;case 3:b=0,c=j,d=h;break;case 4:b=j,c=0,d=h;break;case 5:b=h,c=0,d=j}return b=acc.add(b,l),c=acc.add(c,l),d=acc.add(d,l),{R:255*b,G:255*c,B:255*d}},cost:0}},HSV:{"import":function(){var a=flatten(arguments);return a.length<3?!1:a[0]<0||a[0]>360||a[1]<0||a[2]<0||a[1]>1||a[2]>1?!1:{HSV:{H:a[0],S:a[1],V:a[2]}}},RGB:{convert:function(a){var b,c,d,e=a.H,f=a.S,g=a.V,h=g*f,i=e/60,j=h*(1-Math.abs(i%2-1)),k=parseInt(i),l=g-h;switch(k){case 0:b=h,c=j,d=0;break;case 1:b=j,c=h,d=0;break;case 2:b=0,c=h,d=j;break;case 3:b=0,c=j,d=h;break;case 4:b=j,c=0,d=h;break;case 5:b=h,c=0,d=j}return b+=l,c+=l,d+=l,{R:255*b,G:255*c,B:255*d}},cost:0}},XYZ:{"import":function(){var a=flatten(arguments);return a.length<3?!1:{XYZ:{X:a[0],Y:a[1],Z:a[2]}}},RGB:{convert:function(a){var b=55460*a.X-213955*a.Y+1207070*a.Z>>20,c=-965985*a.X+1967119*a.Y+47442*a.Z>>20,d=3229543*a.X-1611819*a.Y-569148*a.Z>>20;return d>255?d=255:0>d&&(d=0),c>255?c=255:0>c&&(c=0),b>255?b=255:0>b&&(b=0),{R:d,G:c,B:b}},cost:1},Lab:{convert:function(a){var b,c,d,e,f,g,h=20,i=70,j=a.X/242.36628,k=a.Y/255,l=a.Z/277.63227;return k>.008856?(c=Math.pow(k,1/3),e=116*c-16):(c=7.787*k+16/116,e=903.3*k),b=j>.008856?Math.pow(j,1/3):7.787*j+16/116,d=l>.008856?Math.pow(l,1/3):7.787*l+16/116,f=500*(b-c),g=200*(c-d),h>e&&(f*=Math.exp((e-h)/(h/4)),g*=Math.exp((e-h)/(h/4)),e=h),g>i&&(g=i),{L:e,a:f,b:g}},cost:1}},Lab:{"import":function(){console.log(arguments);var a=flatten(arguments);return a.length<3?!1:{Lab:{L:a[0],a:a[1],b:a[2]}}},XYZ:{convert:function(a){var b,c,d,e,f,g,h=a.L,i=a.a,j=a.b;return c=Math.pow((h+16)/116,3),.008856>c&&(c=h/903.3),f=c,c=c>.008856?Math.pow(c,1/3):7.787*c+16/116,b=i/500+c,e=b>.206893?Math.pow(b,3):(b-16/116)/7.787,d=c-j/200,g=d>.206893?Math.pow(d,3):(d-16/116)/7.787,e*=242.36628,f*=255,g*=277.63227,{X:e,Y:f,Z:g}},cost:1}}},defaults={colors:[]};ColorConverter.prototype={constructor:ColorConverter,"import":function(){for(var argu=Array.prototype.slice.call(arguments)[0],output=[],self=this,i=0;i<argu.length;i++){var _temp=flatten(argu[i]),_format=_temp.shift(),_para=_temp;if(!spaces.hasOwnProperty(_format))throw Error("Unsupport color spaces");var _obj=eval("(spaces."+_format+".import)");if(_obj===undefined)throw Error("Cannot convert from "+_format);var _res=_obj.call(this,_para);_res?(self.colors.push(_res),output.push(self.colors.length-1)):output.push(!1)}return output},"export":function(){var argu=flatten(arguments),format=argu.shift(),list=argu,output=[],self=this;if(!list.length)for(var i in self.colors)self.colors.hasOwnProperty(i)&&list.push(i);return list.forEach(function(_i){var _code=self.colors[_i];if(_code===undefined)throw Error("Undefined color");for(var _key=function(a){for(var b in a)return b}(_code),_temp=_code[_key],_tokens=[{_path:[_key],_cost:0,_terminal:!1}],_target=format,_depth=0;!function(a,b){for(var c in a)if(a.hasOwnProperty(c)&&!a[c]._terminal)return!1;return!0}(_tokens,_target)&&10>_depth;){var _deplicate=[];for(var key in _tokens)if(_tokens.hasOwnProperty(key)){var _on=_tokens[key],_nowkey=_on._path.getLast();if(spaces.hasOwnProperty(_nowkey)){var _obj=eval("(spaces."+_nowkey+")");for(var key in _obj)if(_obj.hasOwnProperty(key)){var _temp=_on.clone();_on._path.search(key)||_on._path.getLast()==_target?_temp._terminal=!0:(_temp._path.push(key),_temp._cost+=eval("(spaces."+_nowkey+"."+key+".cost)")),_deplicate.push(_temp)}_obj=null}}_tokens=_deplicate,_deplicate=null,_depth++}if(!_tokens.length)throw Error("No path to target");var _sort=[];for(var key in _tokens)_tokens.hasOwnProperty(key)&&_tokens[key]._path.getLast()==_target&&_sort.push(_tokens[key]);_sort.sort(function(a,b){return a.cost>b.cost?-1:1});for(var _rp=_sort[0]._path,_temp=eval("(_code."+_rp[0]+")"),i=1;i<_rp.length;i++)_temp=eval("(spaces."+_rp[i-1]+"."+_rp[i]+".convert("+JSON.stringify(_temp)+"))");output.push(_temp)}),output},reset:function(){var a=this;return a.colors=[],!0}},window.ColorConverter=ColorConverter}(window,document);